-- Path:staging/stg_payments.sql
{{ config(materialized='view', tags=['staging']) }}

with stg_payments as (
    select 
        payment_id,
        order_id,
        payment_date::date as payment_date,
        mode_of_payment,
        payment_status,
        created_at::timestamp as created_payment_at,
        updated_at::timestamp as updated_payment_at
    from {{ source('datafeed', 'raw_payments') }}
)
select * from stg_payments;
